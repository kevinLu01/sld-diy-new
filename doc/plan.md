# 生利达冷冻设备 DIY 商城（前台+后台）产品方案与技术选型

## 1. 项目目标

基于现有两个原型（`index.html` 前台移动端、`admin.html` 后台管理台），将业务从“展示型页面”升级为“可配置、可报价、可跟进”的轻量交易闭环：

1. 用户端：支持「一键套用方案包 + DIY 微调 + 提交询价」。
2. 运营端：可配置方案包、价格策略、兼容规则和前台展示内容。
3. 销售端：可接收询价线索并推进报价/成交。

---

## 2. 产品定位与核心价值

### 2.1 前台（移动端）定位
- 面向工程采购/门店负责人/项目经理，降低选型门槛。
- 优先提供“推荐方案包”，再允许专业用户做细节微调。

### 2.2 后台（管理台）定位
- 面向运营、技术支持、销售与财务。
- 以“方案包中台”统一管理 SKU、规则、价格和内容，避免前台写死。

---

## 3. 角色与权限设计（建议）

| 角色 | 主要职责 | 关键权限 |
|---|---|---|
| 超级管理员 | 系统配置、组织权限 | 全部权限 |
| 运营 | 上下架方案包、配置文案、活动标签 | 方案包/内容管理 |
| 技术工程师 | 配置兼容规则、审核技术参数 | 规则引擎、技术审批 |
| 销售 | 跟进询价、维护报价版本 | 线索/订单管理 |
| 财务 | 审核价格策略、毛利阈值 | 价格策略审批 |

---

## 4. 业务流程（MVP）

### 4.1 前台用户流程
1. 进入首页查看推荐方案包。
2. 一键套用方案包（自动带入默认配置和价格）。
3. 可选：切换场景并微调组件。
4. 提交询价（联系人、电话、项目地址、期望工期）。
5. 生成询价单并进入销售跟进池。

### 4.2 后台运营流程
1. 维护 SKU 组件库（压缩机、冷风机、阀件、安装服务等）。
2. 组合方案包并设置适用面积/场景/默认配置。
3. 配置价格规则（地区系数、辅材阶梯价、促销模板）。
4. 配置兼容规则（温区、电源、制冷剂、面积阈值）。
5. 发布方案包，前台实时可见。

---

## 5. 功能模块设计

### 5.1 前台模块
1. **方案包推荐**：展示方案名称、适用范围、核心组件、价格。
2. **DIY 微调**：替换组件、增减服务、实时价格联动。
3. **兼容校验**：不兼容时提示原因并给替代件。
4. **询价提交**：表单校验 + 去重 + 成功回执。
5. **进度查询（可选二期）**：查看询价状态/报价版本。

### 5.2 后台模块
1. **方案包管理**：创建、复制、版本化、发布/下架。
2. **SKU 组件库**：参数、库存状态、价格、是否可替代。
3. **规则引擎**：兼容规则、冲突规则、推荐规则。
4. **价格策略**：基础价、地区系数、毛利红线、活动价。
5. **询价/订单池**：线索分配、状态流转、跟进记录。
6. **内容配置 CMS**：前台 Banner、标签、文案配置。
7. **权限与审计**：关键变更留痕（谁在何时改了什么）。

---

## 6. 数据模型（核心实体）

1. `solution_package`：方案包主表（名称、场景、状态、版本、默认价格）。
2. `solution_package_item`：方案包组件明细（SKU、数量、是否可替换）。
3. `sku`：组件参数（型号、功率、温区、电源、制冷剂、基准价）。
4. `rule_definition`：规则定义（条件表达式、动作、优先级）。
5. `pricing_policy`：定价策略（地区、阶梯、折扣、毛利阈值）。
6. `inquiry`：询价单（客户信息、项目信息、当前总价、状态）。
7. `inquiry_quote`：报价版本（版本号、价格明细、有效期）。
8. `audit_log`：审计日志（操作人、模块、变更前后快照）。

---

## 7. 技术选型建议

## 7.1 总体原则
- 先快速上线 MVP，再逐步模块化。
- 前后端分离，后端 API-first。
- 规则与价格逻辑可配置化，避免硬编码。

### 7.2 前端选型

#### 用户端（移动 H5）
- **框架**：Vue 3 + TypeScript
- **UI**：Vant（移动端组件库）
- **状态管理**：Pinia
- **构建**：Vite
- **原因**：开发效率高、移动组件成熟、学习成本低。

#### 后台管理端
- **框架**：Vue 3 + TypeScript
- **UI**：Element Plus / Naive UI（二选一）
- **表格能力**：内置 Table + 虚拟滚动（大数据量可加 AgGrid）
- **原因**：与用户端同技术栈，团队维护成本低。

### 7.3 后端选型

- **语言/框架**：Java 17 + Spring Boot 3（或 Node.js NestJS，二选一）
- **推荐默认**：Spring Boot 3
- **原因**：
  1. 企业级稳定性与生态完整（鉴权、事务、审计）。
  2. 适合规则与价格等强业务逻辑场景。
  3. 便于后续接 ERP/CRM/WMS 等企业系统。

### 7.4 数据与中间件

- **数据库**：MySQL 8（主业务库）
- **缓存**：Redis（热数据、报价缓存、验证码/限流）
- **消息队列**（二期可加）：RabbitMQ/Kafka（异步通知、审计流水）
- **对象存储**：MinIO/OSS（方案附件、报价单文件）

### 7.5 规则引擎实现建议

MVP 阶段建议采用“数据库规则 + 代码解释器”方案：
- 规则配置存库（条件字段、操作符、阈值、动作）。
- 后端统一计算兼容结果与替代推荐。
- 优点：可控、上线快。

二期再考虑 Drools 等复杂规则引擎。

### 7.6 部署与运维

- **容器化**：Docker + Docker Compose（MVP）
- **生产编排**：Kubernetes（后续）
- **网关**：Nginx / APISIX
- **日志**：ELK 或 Loki + Grafana
- **监控**：Prometheus + Grafana

---

## 8. API 设计（MVP 示例）

1. `GET /api/packages`：获取方案包列表（支持场景筛选）。
2. `GET /api/packages/{id}`：获取方案包详情（组件清单+默认价格）。
3. `POST /api/pricing/calc`：根据当前配置计算价格。
4. `POST /api/rules/validate`：校验兼容性并返回替代推荐。
5. `POST /api/inquiries`：提交询价单。
6. `GET /api/admin/packages`：后台查询方案包。
7. `POST /api/admin/packages`：后台新建/更新方案包。
8. `POST /api/admin/packages/{id}/publish`：发布方案包。

---

## 9. 里程碑计划

### M1（2~3 周）：可演示 MVP
- 前台：方案包展示、一键套用、询价提交。
- 后台：方案包 CRUD、SKU 维护、基础发布。
- 输出：可跑通“前台提交询价 -> 后台接收线索”。

### M2（3~4 周）：业务可用版本
- 接入价格策略与兼容规则。
- 增加询价跟进状态流转与报价版本。
- 增加基础权限控制（RBAC）。

### M3（4 周+）：规模化增强
- 审计与操作日志完善。
- 区域化定价与促销模板。
- 与 ERP/CRM 对接。

---

## 10. 风险与控制

1. **规则复杂度膨胀**：先限定规则类型，再逐步扩展。
2. **价格争议**：引入毛利红线 + 审批流。
3. **内容与价格不一致**：发布时做校验门禁。
4. **跨部门协同慢**：用版本化方案包和变更日志提升协作效率。

---

## 11. 与现有原型的映射关系

- 前台原型 `index.html`：对应“用户选型与询价链路”。
- 后台原型 `admin.html`：对应“方案包中台管理能力”。
- 本方案将两者连接为一套“可配置、可运营、可追踪”的业务系统。
